# Pedestrian Blocker (видео с регистратора)

Приложение на **Python 3.14** с GUI на **CustomTkinter** для обнаружения **пешеходов**, которые **мешают движению авто** на видео с регистратора.

В основе детекции — **Ultralytics YOLO** (можно выбрать модель и устройство: CPU/CUDA/MPS).

## Возможности

- Открытие видеофайла и предпросмотр
- Детекция класса **person** (пешеход)
- Определение “мешает” через **настраиваемую зону интереса (ROI)** в процентах кадра
- Аннотация: bbox + ROI + статус “мешает”
- Экспорт:
  - аннотированного видео (опционально)
  - JSON-лога событий (“мешает”: интервалы времени)

## Установка

Рекомендуется виртуальное окружение:

```bash
python3.14 -m venv .venv
source .venv/bin/activate
python -m pip install -U pip
pip install -r requirements.txt
```

Если у вас `python3.14` не найден (как в терминале “command not found”), поставьте Python 3.14 одним из способов:

- **Homebrew**:

```bash
brew install python@3.14
python3.14 -V
```

- **pyenv**:

```bash
brew install pyenv
pyenv install 3.14.2
pyenv local 3.14.2
python -V
```

Примечание по **PyTorch**: на macOS/M1-M4 обычно удобнее ставить сборку с **MPS**, на NVIDIA — с **CUDA**. `ultralytics` подтянет `torch`, но при проблемах поставьте PyTorch согласно официальной инструкции и затем повторите `pip install -r requirements.txt`.

## Запуск

```bash
python run_app.py
```

Альтернатива (после установки пакета):

```bash
pip install -e .
python -m pedblock
```

## Как работает “пешеход мешает”

Считаем, что пешеход “мешает”, если **центр bbox** попадает в прямоугольник ROI (задаётся процентами кадра), и bbox не слишком маленький (порог площади в процентах кадра).

ROI можно настроить в UI под ваш ракурс регистратора (обычно — нижняя центральная часть кадра).


